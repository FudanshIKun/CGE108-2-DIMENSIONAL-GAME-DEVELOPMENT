# Speech Script



---

สมาชิกรายชื่อ

---

ครับก็ ในส่วนประกอบหลักๆที่คอยควบคุมตัวเกมโดยรวมจะประกอบด้วย 3 class หลักๆ คือ gamemanager, datamanager และ ui manager นะคับ

- GameManager.cs

​	จะแบกรับภาระในการเชื่อมต่อระหว่าง Scene และแจ้งสถานะปัจจุบันของ Scene โดยการรับข้อมูลใหม่จาก Scene ที่มีการโหลดทุกครั้งคับ และรายงานให้ Script อื่นๆทราบคับ โดยคลาสนี้จะเป็น Singleton คับ

- DataManager.cs

​	จะแบกรับการจัดการข้อมูลของเกมที่เกี่ยวข้องกับระบบข้อมูลของเกมคับ และแจกจ่ายฟังก์ชั่นต่างๆที่เกี่ยวกับข้อมูลให้กับ Scripts อื่นๆคับ และเป็น Singleton class เช่นกัน

- UIManager.cs

​	จะแบกรับฟังก์ชั่นหลักๆ ที่ทุก Scene ต้องใช้เนื่องจากแต่ละ Scene มี script UI เป็นของตัวเอง จึงสร้าง UIManager มาเพื่อแบกรับการทำงานที่คล้ายคลึงกันใน script UI หลายๆ scripts คับ

ทั้งหมดที่มานี้คือ ในส่วนของ Core script ของระบบเกมคับ

---

ต่อมาในส่วนแรกเราจะอธิบายในส่วนการทำงานของระบบจัดการข้อมูลในเกมนะคับ

ในการจัดการข้อมูลของเกมนี้ประกอบด้วย script หลักๆ ได้แก่ DataManager, IDataManager, FileDataHandler, SerializableDictionary และ GameData นะคับ

โดยอย่างแรกคือ เราสร้าง c# class ขึ้นมาเพื่อเป็น object สำหรับเก็บข้อมูลภายในเกมของเรานะคับ นั้นก็คือ GameData.cs

ต่อมาเราสร้าง Singleton Class เพื่อคอย track และจัดการกับ Data เหล่านั้นนะคับ โดยจะทำหน้าที่จัดการกับ object GameData ของเรา แจกจ่ายฟังก์ชั่นที่จำเป็น ได้แก่ NewGame() SaveGame() และ LoadGame() ให้กับ script เพื่อที่จะทำอย่างงั้นเราจึงสร้างInterface ขึ้นมา คือ IDataManager ซึ่งเก็บฟังก์ชั่นอย่าง LoadData() และ SaveData() ไว้ เพื่อ Implement Interface นี้ให้กับ script ที่ทำงานร่วมกับการ DataManager เพื่อที่ทุกครั้งที่ DataManager เรียกใช้ฟังก์ชั่น มันจะรวบรวม object ที่ implement Interface นี้ และเรียกใช้ฟังก์ชั่นนี้ด้วยทุกครั้งนะฮะ

ต่อมาเมื่อเราจัดการกับข้อมูลภายในเกมเสร็จแล้ว เราก็จะทำการบันทึกข้อมูลเหล่านั้น เป็นไฟล์เก็บไปที่แอสเดรส default ของ window ฮะ โดยเราสร้าง FileDataHandler.cs ขึ้นมาเพื่อเปลี่ยนข้อมูลใน GameData object ปัจจุบัน เป็นไฟล์ .Json และเขียนเป็นไฟล์ในการ Save ข้อมูลของเกมนั้นเอง และเมื่อเราต้องการใช้ข้อมูลเหล่านั้น FileDataHandler ก็จะแปลงข้อมูลเหล่านั้น กลับมาเป็น GameData c# object เพื่อ Load กลับเข้ามาภายในเกมนั้นเองคับ

ส่วนในส่วนของ SerializableDictionary script คือ script ที่จะแปลง Dictionary เป็น List ก่อนที่ Unity จะ serialize object ของคลาสนี้ เพื่อที่จะให้สามารถ Save ข้อมูลในรูปแบบของ Dictionary ภายในเกมได้นะฮะ เนื่องจาก Class JsonUtiliy ที่ใช้ในการทำงานแปลง C# script เป็น .Json ไม่รองรับตัว Dictionary นั้นเองคับ

และทั้งหมดคือ ดีไซน์การทำงานของระบบจัดการข้อมูลภายในเกมนี้นะคับ โดยผมจะไม่อธิบายในส่วนของตัว Code เชิงลึกนะคับ เนื่องจากในส่วนระบบนี้ ผมเองก็เริ่มศึกษาจาก Tutorial และ Documents ต่างๆในอินเทอร์เน็ตเช่นกันคับ

---

ต่อมาจะอธิบายในส่วนของระบบ UI ของเกมนี้นะคับ ซึ่งเป็นส่วนที่ผมทำเองนะคับ

โดยระบบ UI นี้จะสร้างขึ้นจาก UnityEngine.UIElements นะคับ เนื่องจากผมไม่คุ้นชินกับ ระบบ UI เก่าของ Unity เท่าไหร่

รวมถึง ผมจะไม่กล่าวการทำงานกับตัวหน้าต่าง UIBuilder นะคับ แต่จะกล่าวถึงเฉพาะ script ที่มีการอ้างอิงถึงเฉพาะส่วนที่มีการประกาศ using UnityEngine.UIElements

ในส่วนของ UI ประกอบด้วยแค่สอง script นะคับ ได้แก่ MainMenu.cs และ LevelMenu.cs โดยอธิบายอย่างคือ Script ในส่วนนี้จะทำที่ควบคุมการทำงานของ UI ที่แตกต่างกันในแต่ละ Scene โดยเรียกใช้ฟังก์ชั่นจาก UIManager และสื่อสารกับ DataManager และ GameManager เพื่อให้ได้ผลลัพธ์ที่ถูกต้องนั้นเองคับ

---

และในส่วนสุดท้ายคือในส่วนของ GamePlay

ในส่วนของ GamePlay นั้นผมเขียนด้วยตนเองเช่นกัน ซึ่งประกอบด้วย 2 Script หลัก ได้แก่ GamePlayManager.cs และ GamePlayUI.cs โดยผมอาจไม่ได้ลงรายละเอียดทั้งหมดเช่นกัน เนื่องจากทั้ง 2 script นี้เป็นส่วนหลักในการทำงานของ Gameplay จึงมีความยาวและจำนวนบรรทัดมากนะคับ

โดยส่วนแรกคือการสร้าง Story และตัวละครภายในเกมนี้ คือ การสร้าง ScriptableObject c# object แทน Character แต่ละตัว และ Story ในแต่ละส่วนนั้นเอง ซึ่งก็คือ class Character.cs และ StoryScene.cs นั้นเอง

ซึ่งภายใน Class ก็จะจัดเก็บข้อมูลที่จำเป็นของ Character และ Story part นั้นๆ นั้นเอง

ต่อมาในแต่ละ Level Scene นั้น จะมี Setting ของ GamePlayManager object เป็นของตัวเอง ซึ่งตั้งค่าตามเนื้อเรื่องและตัวละคร ผ่าน Object StoryScene ที่เราสร้างและเซตค่าต่างๆไว้นั้นเอง

ซึ่ง GamePlayManager จะอ่านค่าเหล่านั้น และเรียกใช้ฟังก์ชั่นต่างๆผ่าน GamePlayUI ใน Scene เดียวกัน เกิดเป็นเกมเพลย์นั้นเอง

---

สรุปด้วยรวมได้ดังนี้คับ ( แสดงหน้าจอเป็นคำอธิบายฟังก์ชั่นต่างๆ )

---

และนี้คือตัวอย่างเกมเพลย์ครับ โดยตัววินคอนดิทชั่นจะอธิบายอยู่ในตัวเกมนะคับ

